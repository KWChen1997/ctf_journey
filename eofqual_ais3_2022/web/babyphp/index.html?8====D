<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;using&nbsp;php:7.4-apache&nbsp;Dokcer&nbsp;image<br /></span><span style="color: #007700">isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'8'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'8'</span><span style="color: #007700">]&nbsp;===<br /></span><span style="color: #DD0000">'===D'</span><span style="color: #007700">)&nbsp;&amp;&amp;&nbsp;die(</span><span style="color: #0000BB">show_source</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">1</span><span style="color: #007700">));!</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"sandbox/"&nbsp;</span><span style="color: #007700">.<br /></span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">session_start</span><span style="color: #007700">().</span><span style="color: #0000BB">session_id</span><span style="color: #007700">()))&amp;&amp;<br /></span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">);</span><span style="color: #0000BB">chdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">);!isset(</span><span style="color: #0000BB">$_GET<br /></span><span style="color: #007700">[</span><span style="color: #DD0000">'code'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;die(</span><span style="color: #DD0000">'/?8====D'</span><span style="color: #007700">);</span><span style="color: #0000BB">$time&nbsp;</span><span style="color: #007700">=<br /></span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'Y-m-d-H:i:s'</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$out&nbsp;</span><span style="color: #007700">=&nbsp;(<br /></span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'output'</span><span style="color: #007700">]&nbsp;??&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$time</span><span style="color: #DD0000">.html"&nbsp;</span><span style="color: #007700">))&nbsp;&gt;<br /></span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;die(</span><span style="color: #DD0000">'toooooooo&nbsp;loooooong'</span><span style="color: #007700">);&nbsp;(<br /></span><span style="color: #0000BB">trim</span><span style="color: #007700">(</span><span style="color: #0000BB">$ext</span><span style="color: #007700">=</span><span style="color: #0000BB">pathinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">$out</span><span style="color: #007700">)[</span><span style="color: #DD0000">'extension'<br /></span><span style="color: #007700">])&nbsp;!==&nbsp;</span><span style="color: #DD0000">''&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$ext</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">))&nbsp;!==&nbsp;</span><span style="color: #DD0000">"ph"</span><span style="color: #007700">)?</span><span style="color: #0000BB">file_put_contents&nbsp;</span><span style="color: #007700">(<br /></span><span style="color: #0000BB">$out</span><span style="color: #007700">,</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'/va'<br /></span><span style="color: #007700">.</span><span style="color: #DD0000">'r/www/html/template.html'</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$time</span><span style="color: #007700">,<br /></span><span style="color: #0000BB">highlight_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'code'</span><span style="color: #007700">],</span><span style="color: #0000BB">true</span><span style="color: #007700">)<br />))&nbsp;:&nbsp;die(</span><span style="color: #DD0000">"BAD"</span><span style="color: #007700">);&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;p&gt;Highlight:<br />&lt;a&nbsp;href=\"/</span><span style="color: #0000BB">$dir</span><span style="color: #DD0000">/</span><span style="color: #0000BB">$out</span><span style="color: #DD0000">\"&gt;</span><span style="color: #0000BB">$out</span><span style="color: #DD0000">&lt;/a&gt;&lt;/p&gt;"<br /></span><span style="color: #FF8000">//&nbsp;You&nbsp;might&nbsp;also&nbsp;need:&nbsp;/phpinfo.php<br /></span><span style="color: #0000BB">?&gt;<br /></span>
</span>
</code>